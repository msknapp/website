<!DOCTYPE html>
<html lang="en-US">

<head>
    <title>Michael Knapp&#39;s Home Page</title>
    <meta charset="UTF-8">
    <meta name="description" content="Portfolio site for Michael Knapp">
    <meta name="keywords" content="golang resume">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/website/css/site.css">
    <link rel="stylesheet" href="/website/css/footer.css">
    <link rel="stylesheet" href="/website/css/content.css">
    <link rel="stylesheet" href="/website/css/listnav.css" />
    <link rel="stylesheet" href="/website/css/breadcrumbs.css" />
    <link rel="stylesheet" href="/website/css/sitenav.css" />
    <link rel="stylesheet" href="/website/css/sectionmenu.css" />
    <link rel="stylesheet" href="/website/css/tocmenu.css" />

    <link rel="stylesheet" media="print" href="/website/css/print.css" />
</head>

<body><div class="sitenav">
    <h2 class="sitenav">Sections</h2>
    <nav class="sitenav">
        <ul>
            <li class="sitenav ">
                <a class="sitenav " href="/"><img src="/icons/house.png"
                        width="20px" /></a>
            </li>
            
            <li class="sitenav">
                <a class="sitenav"
                    href="/website/principles/" title="my description.">
                    Principles</a>
            </li>
            <li class="sitenav currentsection">
                <a class="sitenav currentsection"
                    href="/website/reliability/" title="robust software system design">
                    Reliability</a>
            </li>
            <li class="sitenav">
                <a class="sitenav"
                    href="/website/architecture/" title="robust software system design">
                    Architecture</a>
            </li>
            <li class="sitenav">
                <a class="sitenav"
                    href="/website/algorithms/" title="Software algorithms.">
                    Algorithms</a>
            </li>
            <li class="sitenav">
                <a class="sitenav"
                    href="/website/tech/" title="Notes about software engineering.">
                    Tech</a>
            </li>
            <li class="sitenav">
                <a class="sitenav"
                    href="/website/blog/" title="A blog on software engineering.">
                    Blog</a>
            </li>
            <li class="sitenav">
                <a class="sitenav"
                    href="/website/cheat-sheets/" title="Software engineering cheat sheets.">
                    Cheat Sheets</a>
            </li>
        </ul>
    </nav>
</div>
    <div class="body"><aside>
    <h2 class="sectionmenu">Pages</h2>
    <ul class="sectionmenu">
        
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/version-control/" title="">
                Version Control</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/code-quality/" title="">
                Code Quality</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/separation-of-duties/" title="">
                Separation of Duties</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/iac/" title="">
                Configuration Management</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/cicd/" title="">
                CICD</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu currentpage"
                href="/website/reliability/testing/" title="">
                Testing</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/environment-parity/" title="">
                Environment Parity</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/probes-and-signals/" title="">
                Application States and Signals</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/boot-and-shutdown/" title="">
                Boot and Shutdown Times</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/stateless/" title="">
                Stateless</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/deployment-patterns/" title="">
                Deployment Patterns</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/availability/" title="">
                High Availability</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/load-balancing/" title="">
                Load Balancing</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/monitoring/" title="">
                Monitoring</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/security/" title="">
                Security</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu"
                href="/website/reliability/documentation/" title="">
                Documentation</a>
        </li>
    </ul>
</aside><div class="rightcolumn">
        <div class="rightcontent">
                <div class="tocmenu arrow"><a class="tocmenu arrow" href="/website/reliability/cicd/"
                                title="CICD">
                                <img src="/icons/arrow-left-circle-white.png" class="tocmenu arrow" /></a><a class="tocmenu arrow" href="/website/reliability/" title="Reliable Software Systems">
                                <img src="/icons/arrow-up-circle-white.png" class="tocmenu arrow" /></a>
                        <a class="tocmenu arrow" href="/website/reliability/environment-parity/"
                                title="Environment Parity"><img src="/icons/arrow-right-circle-white.png"
                                        class="tocmenu arrow" /></a>
                </div>
                <hr class="tocmenu">
                <p class="tocmenu">Table of Contents:</p><nav id="TableOfContents">
  <ul>
    <li><a href="#unit-tests">Unit tests</a></li>
    <li><a href="#integration-tests">Integration Tests</a></li>
    <li><a href="#system-tests">System Tests</a></li>
    <li><a href="#performance-tests">Performance Tests</a></li>
    <li><a href="#chaos-testing">Chaos Testing</a></li>
    <li><a href="#migration-testing">Migration Testing</a></li>
  </ul>
</nav>
        </div>
</div>
        <div class="middlecolumn"><div class="breadcrumbs">
    <h2 class="breadcrumbs">BreadCrumbs</h2>
    <ul class="breadcrumbs">
        <li class="breadcrumbs"><a href="/website/" class="breadcrumbs">/Michael Knapp&#39;s Home Page</a></li>
        <li class="breadcrumbs"><a href="/website/reliability/" class="breadcrumbs">/Reliability</a></li>
    </ul>
</div>
            <article>
                <main>
                    <h1 class="title">Testing</h1>
<p>The number one best defense against failures and incidents in your cluster is ample
testing.  This comes in a variety of forms.</p>
<h1 id="unit-tests">Unit tests</h1>
<p>Any code that is mission critical and running in a production environment should have
ample unit tests, which cover low-level functions in the code.  Typically teams should
set a minimum required amount of coverage, around 80%.  The language chosen may
impact this, for example, Python code could require higher coverage because it
doesn&rsquo;t require errors be checked.</p>
<h1 id="integration-tests">Integration Tests</h1>
<p>These are higher level, involving at least one external system in their tests.  Ideally
these should be run automatically, like at the end of a CICD stage, or on a cron
schedule.</p>
<h1 id="system-tests">System Tests</h1>
<p>These run in a real live cluster, as similar to production as possible.  They involve all
of the services, and are tested the same way a user would interact with the system.
These can also be called &ldquo;end to end&rdquo; (e2e) tests.</p>
<p>I do not recommend going past the beta stage of a product unless system tests exist and
are automatically run.  Lacking automated system tests is bound to result in production incidents.</p>
<h1 id="performance-tests">Performance Tests</h1>
<p>These could be run by JMeter for example.  They confirm your system can auto-scale, and can
handle the higher traffic levels it might encounter.  Pair this with tracing and you can
identify bottlenecks in your service easily.</p>
<h1 id="chaos-testing">Chaos Testing</h1>
<p>We are trying to build a system that is highly available, but this assumes that
certain failure modes <em>happen</em>.  In practice, they are rare, meaning you don&rsquo;t
learn about them until it happens in production and is a major incident, costing
the company millions of dollars.  That is why you need something to prove the
system&rsquo;s fault tolerance.</p>
<p>Chaos testing or engineering works by randomly breaking certain aspects,
components, or connections of your service.  For example, it might terminate a node, virtual
machine, or a single replica in your cluster.  It might block connections to some
external service for a period of time.</p>
<p>If your cluster really is fault tolerant, it should just recover by itself with no intervention.  If
not, at least you know about it now, before it really impacts anybody.</p>
<h1 id="migration-testing">Migration Testing</h1>
<p>This is not really a &ldquo;thing&rdquo; you would read or hear about if you searched for software
testing methods.  I want to call out, that changing your APIs and/or data involves
risk.  Often times, a developer is only thinking about the <em>end state</em> of their
software, and not how to get there in the first place.  In other words, they are
not thinking about backwards compatibility.</p>
<p>For example, you may have two services and one table they both use.  A developer
may decide to add a new field in the table, and update both of the services to use
that.  Whenever a new record is created, that new field will be set.</p>
<p>What the developer didn&rsquo;t think about is:</p>
<ul>
<li>What about all the records that already exist?</li>
<li>What if one of the services needs to be rolled back?</li>
<li>What if the database change needs to be rolled back?</li>
</ul>
<p>So they should make a procedure for how to update all existing records, and how to
make the services backwards compatible.  They should each be able to function
if their peers are rolled back, this is backwards compatibility.  You should
never be required to deploy data updates and multiple service updates all at once,
nor to roll them back all together.</p>
<p>What&rsquo;s often neglected is that, <em>these procedures need to be tested!</em>  and
critically, <em>that includes roll back procedures!</em> if they will be done manually, or are
one-time procedures.  The services each need to be tested with different
versions of their peers too.</p>
<p>This is what I am calling &ldquo;migration testing&rdquo;.</p>


                </main>
            </article><hr class="footerline">
<footer>
    <a class="footerprevious" href="/website/reliability/cicd/" title="CICD">
        <img src="/icons/arrow-left-circle-black.png" class="footerarrow arrow" /><span class="footerlinktext">
            previous</span></a>
    <div class="footermiddle">
        <div class="lastmod">Last Modified: <time datetime="2023-03-22 00:00:00 &#43;0000 UTC">
                March 22, 2023</time></div>
        <b>&#169; 2023 Michael Knapp</b>
    </div>
    <a class="footernext" href="/website/reliability/environment-parity/" title="Environment Parity">
        <span class="footerlinktext">next </span>
        <img src="/icons/arrow-right-circle-black.png" class="footerarrow arrow" /></a>
</footer>
        </div>
    </div>
</body>

</html>