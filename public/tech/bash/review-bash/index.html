<!DOCTYPE html>
<html lang="en-US">

<head>
    <title>Michael Knapp&#39;s Home Page</title>
    <meta charset="UTF-8">
    <meta name="description" content="Portfolio site for Michael Knapp">
    <meta name="keywords" content="golang resume">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/site.css">
    <link rel="stylesheet" media="print" href="/css/print.css" />
</head>

<body>
    <h1 class="topheader">Bash Review</h1>
    <div class="navigation">
        <nav>
            <a href="/">Home</a>
            
            <a href="/tech/">Software Engineering</a>
            
            <a href="/algorithms/">Algorithms</a>
            
            <a href="/principles/">Principles</a>
            
            <a href="/applications/">Applications</a>
            
            <a href="/cheat-sheets/">Cheat Sheets</a>
            
            <a href="/open-source/">Open Source</a>
            
            <a href="/architecture/">Architecture</a>
            
            <a href="/blog/">Blog</a>
            
        </nav>
    </div>
    <div class="body">
        <aside>
        </aside>
        
<article>
    <main>
        <p>Review Questions:</p>
<p>What do these tell you:
$$
$?
:
$*
$@
$#
((  ))
$(  )
${parameter}
[  ]
[[  ]]
.
source</p>
<p>What is the difference between [ ], [[ ]], ( ), and (( )) ?
How do you get the last column using gawk?
How do you make variables you set ALWAYS carry through to sub-shells? and undo that?
How do you make the &lsquo;&gt;&rsquo; operator NEVER overwrite existing files? and undo that?
What keyboard shortcut clears the screen?
What keyboard shortcut exits a sub-shell?
How do you copy lines in vi?
How do you insert a prefix before many lines in vi?
How do you remove a prefix before many lines in vi?
In a bash script, how do you get input from a user?
How you you print a line without a new line?
How do you duplicate a line in vi?
In vi, how do you auto-indent? see line numbers?  and disable these features?
In vi, how do you set a bookmark and navigate between them?</p>
<p>==============================
Answers:</p>
<p>$$ gives you the process id of the current process</p>
<dl>
<dt>$? tells you the exit code of the last sub process</dt>
<dt>michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ &ldquo;false&rdquo;</dt>
<dt>michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ echo $?</dt>
<dt>1</dt>
<dt>michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ echo $?</dt>
<dt>0</dt>
<dd>
<p>is the no-op operator, it always exits with exit code of true</p>
<p>michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ if ( : ); then echo &ldquo;true&rdquo; ; else echo &ldquo;false&rdquo; ; fi
true
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ if ( ! : ); then echo &ldquo;true&rdquo; ; else echo &ldquo;false&rdquo; ; fi
false
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ if [ : ]; then echo &ldquo;true&rdquo; ; else echo &ldquo;false&rdquo; ; fi
true
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ if [ ! : ]; then echo &ldquo;true&rdquo; ; else echo &ldquo;false&rdquo; ; fi
false</p>
</dd>
</dl>
<p>$* means all arguments to the given script, not quoted, not including the script name
$@ is like $* except keeps text quoted.
$# tells you how many arguments there are to a bash script
. from command line means to execute the file.
source
${parameter} gives you the value of the named variable parameter.  It does NOT evaluate the parameter as an expression.  For example:</p>
<pre><code>michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ echo ${ls | head -1}
bash: ${ls | head -1}: bad substitution
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ echo $(ls | head -1)
mesos.txt
</code></pre>
<p>$( ) will actually evaluate the expression inside it and return its output.  It is equivalent to using back-ticks, <code>expr</code>.</p>
<p>&lsquo;return&rsquo; will exit a function with the provided exit code.  Zero is default.  If a function never has a return, then the exit code is that of its last operation.  Return statements do NOT set the value that is received by $(), you must use the standard output stream to accomplish that.</p>
<pre><code>#!/bin/bash

function f1() {
        return &quot;foo&quot;
}

function f2() {
        echo &quot;foo&quot;
        return 1
}

function f3() {
        echo &quot;foo&quot;
        return 0
}


echo &quot;\${f1} value is: ${f1}, \${f2} value is ${f2}&quot;
# These both print nothing because ${} is used to get variable values, not to evaluate expressions

echo &quot;\$(f1) value is: $(f1)&quot;
# This prints nothing because return does not return a value, it sets the exit code.

echo &quot;\$(f2) value is: $(f2)&quot;
# prints foo because that was the output of running that expression.  f3 would have the same output.

# All three of these claim to be successful, because they are wrapped in the 'test'.  
if [ f1 ]; then echo &quot;test f1 has an exit code of 0 (true/success)&quot;; else echo &quot;test f1 has an exit code of non-zero (false/failure)&quot;; fi
if [ f2 ]; then echo &quot;test f2 has an exit code of 0 (true/success)&quot;; else echo &quot;test f2 has an exit code of non-zero (false/failure)&quot;; fi
if [ f3 ]; then echo &quot;test f3 has an exit code of 0 (true/success)&quot;; else echo &quot;test f3 has an exit code of non-zero (false/failure)&quot;; fi

if f1; then echo &quot;f1 has an exit code of 0 (true/success)&quot;; else echo &quot;f1 has an exit code of non-zero (false/failure)&quot;; fi
if f2; then echo &quot;f2 has an exit code of 0 (true/success)&quot;; else echo &quot;f2 has an exit code of non-zero (false/failure)&quot;; fi
if f3; then echo &quot;f3 has an exit code of 0 (true/success)&quot;; else echo &quot;f3 has an exit code of non-zero (false/failure)&quot;; fi
</code></pre>
<p>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-  The output:  &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ ./example.sh
${f1} value is: , ${f2} value is
./example.sh: line 4: return: foo: numeric argument required
$(f1) value is:
$(f2) value is: foo
test f1 has an exit code of 0 (true/success)
test f2 has an exit code of 0 (true/success)
test f3 has an exit code of 0 (true/success)
./example.sh: line 4: return: foo: numeric argument required
f1 has an exit code of non-zero (false/failure)
foo
f2 has an exit code of non-zero (false/failure)
foo
f3 has an exit code of 0 (true/success)</p>
<p>&mdash;&mdash;&mdash;&mdash; Lesson learned: &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-
It&rsquo;s probably a mistake to use [ ] around any function call, it will always return true.  Test is meant to evaluate special expressions, not function calls.</p>
<p>You can set defaults for parameters with a hyphen and then a default, ${parameter-default}, or you can insert a colon, ${parameter:-default}, like so:</p>
<pre><code>michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ echo $FRUIT

michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ echo ${FRUIT-apple}
apple
</code></pre>
<p>() starts a sub-shell, you can do multiple commands in it.  It is a sub-shell, but somehow it still observes variables you set outside of it.  Anything you set inside it is not seen outside of it.  It&rsquo;s like a closure.</p>
<pre><code>michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ echo $FRUIT
apple
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ (echo $FRUIT)
apple
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ (FRUIT=banana;echo $FRUIT)
banana
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ (FRUIT=banana); echo $FRUIT
apple
</code></pre>
<p>(( )) expands and evaluates an arithmetic expression. If the expression evaluates as zero, it returns an exit status of 1, or &ldquo;false&rdquo;. A non-zero expression returns an exit status of 0, or &ldquo;true&rdquo;.
Notice that &lsquo;=&rsquo; is assignment inside these, so use &lsquo;==&rsquo; to compare values.</p>
<pre><code>michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ if (( 0 == 1-1 )); then echo &quot;true&quot;; else echo &quot;false&quot;; fi
true
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ if [[ 0 == 1-1 ]]; then echo &quot;true&quot;; else echo &quot;false&quot;; fi
false
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ if (( 0 )); then echo &quot;true&quot;; else echo &quot;false&quot;; fi
false
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ if (( 1 )); then echo &quot;true&quot;; else echo &quot;false&quot;; fi
true
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ if [[ 0 ]]; then echo &quot;true&quot;; else echo &quot;false&quot;; fi
true
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ if [[ 1 ]]; then echo &quot;true&quot;; else echo &quot;false&quot;; fi
true

That can also be used to evaluate simple arithmetic operations, but it won't work correctly with floating point operations.
</code></pre>
<p>[ ] specifically checks the exit code of what it runs.  An exit code of 0 is treated as success/true, otherwise it is false. [ is a bash built-in, and is a synonym for test, not /usr/bin/test.
the &amp;&amp;, ||, &lt;, and &gt; operators work within a [[ ]] test, despite giving an error within a [ ] construct.</p>
<p>[[  ]]	the &amp;&amp;, ||, &lt;, and &gt; operators work within a [[ ]] test, despite giving an error within a [ ] construct.
Following an if statement, you don&rsquo;t need to have [ or [[, it&rsquo;s implied.</p>
<p>What is the difference between [ ], [[ ]], ( ), and (( )) ?</p>
<p>How do you get the last column using gawk?
gawk -e &lsquo;{print $NF}&rsquo;  &ndash;&gt; You must use single quotes here so the shell does not attempt to replace $NF.</p>
<p>How do you make variables you set ALWAYS carry through to sub-shells? and undo that?
set -o allexport<br>
set +o allexport</p>
<p>How do you make the &lsquo;&gt;&rsquo; operator NEVER overwrite existing files? and undo that?
set -o noclobber
set +o noclobber</p>
<p>What keyboard shortcut clears the screen?
ctrl+l</p>
<p>What keyboard shortcut exits a sub-shell?
ctrl+d
you can use &ldquo;set -O ignoreeof&rdquo; to disable that.</p>
<p>How do you copy lines in vi?
in visual mode, use &lsquo;y&rsquo; to copy.</p>
<p>How do you insert a prefix before many lines in vi?
ctrl+v
move to cover all necessary lines
shift+i
type what you want to be the prefix
hit escape, wait two seconds.  done.</p>
<p>How do you remove a prefix before many lines in vi?
ctrl+v
cover the prefix you want to remove
type &rsquo;d'.  done</p>
<p>In a bash script, how do you get input from a user?  &lsquo;read&rsquo;
How you you print a line without a new line? echo -n &ldquo;my prompt: &quot;</p>
<p>How do you duplicate a line in vi?
Go to the line,
type &lsquo;yy&rsquo; or &lsquo;Y&rsquo;
Go to where you want the line cloned to
type &lsquo;p&rsquo;
~ or ~
type &lsquo;YP&rsquo; on the line you want duplicated.</p>
<p>In vi, how do you auto-indent? see line numbers?  and disable these features?
:set autoindent
:set noautoindent
:set number
:set nonumber</p>
<p>In vi, how do you set a bookmark and navigate between them?
go to the line
type &rsquo;m' then another lower-case letter from a to z
Go about other editing
type a back-tick `, and then the letter to go back to it.</p>
<p>==============================
Other tips:</p>
<p>from command line, do &ldquo;bash -x <!-- raw HTML omitted -->&rdquo; to make it run in debug mode.
from within script, make the first line &ldquo;#!/bin/bash -x&rdquo; to have it always run in debug mode.
use &ldquo;set -x&rdquo; to put a script in debug mode, &ldquo;set +x&rdquo; to exit debug mode.</p>
<p>=====================================
Unexplained Bash behaviour:</p>
<p>if &ldquo;false&rdquo; returns an exit code of 1, why is it a 0 when run as part of a test?</p>
<pre><code>michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ &quot;true&quot;
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ echo $?
0
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ &quot;false&quot;
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ echo $?
1
michael@michael-GA-890GPA-UD3H ~/information_technology_notes $ if [ &quot;false&quot; ]; then echo &quot;true&quot;; else echo &quot;false&quot;; fi
true
</code></pre>

    </main>
</article>

    </div>
</body>

</html>