<!DOCTYPE html>
<html lang="en-US">

<head>
    <title>Michael Knapp&#39;s Home Page</title>
    <meta charset="UTF-8">
    <meta name="description" content="Portfolio site for Michael Knapp">
    <meta name="keywords" content="golang resume">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/site.css">
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="/css/content.css">
    <link rel="stylesheet" href="/css/listnav.css" />
    <link rel="stylesheet" href="/css/breadcrumbs.css" />
    <link rel="stylesheet" href="/css/sitenav.css" />
    <link rel="stylesheet" href="/css/sectionmenu.css" />
    <link rel="stylesheet" href="/css/tocmenu.css" />

    <link rel="stylesheet" media="print" href="/css/print.css" />
</head>

<body><div class="sitenav">
    <h2 class="sitenav">Sections</h2>
    <nav class="sitenav">
        <ul>
            <li class="sitenav ">
                <a class="sitenav " href="/"><img src="/icons/house.png"
                        width="20px" /></a>
            </li>
            
            <li class="sitenav">
                <a class="sitenav"
                    href="/tech/" title="Notes about software engineering.">
                    Software Engineering</a>
            </li>
            <li class="sitenav">
                <a class="sitenav"
                    href="/algorithms/" title="Software algorithms.">
                    Algorithms</a>
            </li>
            <li class="sitenav currentsection">
                <a class="sitenav currentsection"
                    href="/principles/" title="my description.">
                    Principles</a>
            </li>
            <li class="sitenav">
                <a class="sitenav"
                    href="/applications/" title="browser applications.">
                    Applications</a>
            </li>
            <li class="sitenav">
                <a class="sitenav"
                    href="/cheat-sheets/" title="Software engineering cheat sheets.">
                    Cheat Sheets</a>
            </li>
            <li class="sitenav">
                <a class="sitenav"
                    href="/architecture/" title="Software architecture">
                    Architecture</a>
            </li>
            <li class="sitenav">
                <a class="sitenav"
                    href="/blog/" title="A blog on software engineering.">
                    Blog</a>
            </li>
        </ul>
    </nav>
</div>
    <div class="body"><aside>
    <h2 class="sectionmenu">Pages</h2>
    <ul class="sectionmenu">
        <li class="sectionmenu">
            <a class="sectionmenu" href="/principles/kiss/" title="How to keep your code simple">
                KISS</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu" href="/principles/defensive/" title="Making your code defensive.">
                Defensive Programming</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu" href="/principles/single-responsibility/" title="The importance of single responsibility.">
                Single Responsibility Principle</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu" href="/principles/open-closed/" title="">
                Open Closed Principle</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu" href="/principles/liskov/" title="Explaining the Liskov Substitution Principle">
                Liskov Substitution Principle</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu" href="/principles/segregation/" title="explaining the interface segregation principle">
                Interface Segregation Principle</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu" href="/principles/dependency-inversion/" title="The dependency inversion principle.">
                Dependency Inversion Principle</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu" href="/principles/testing/" title="The importance of software testing.">
                Software Testing</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu" href="/principles/quality/" title="assessing code quality">
                Judging Quality</a>
        </li>
        <li class="sectionmenu">
            <a class="sectionmenu" href="/principles/twelve-factor/" title="">
                Twelve Factor Apps</a>
        </li>
    </ul>
</aside><div class="rightcolumn">
    <div class="rightcontent">
        <div class="metaarrows">
            <a class="metaprevious" href="/algorithms/selection/" title="Selection Sort"><img
                    src="/icons/left-arrow-white.png" width="26px" /></a>
            <a class="metaup" href="/principles/" title="Principles"><img
                    src="/icons/up-arrow-white.png" width="26px" /></a>
            <a class="metanext" href="/tech/bash/sudo/" title="Sudo"><img
                    src="/icons/right-arrow-white.png" width="26px" /></a>
        </div>
        <hr class="meta">
        <p class="toc">Table of Contents:</p><nav id="TableOfContents">
  <ul>
    <li><a href="#immutability">Immutability</a></li>
    <li><a href="#fluent-pattern">Fluent Pattern</a></li>
    <li><a href="#builder-pattern">Builder Pattern</a></li>
    <li><a href="#factory-pattern">Factory Pattern</a></li>
    <li><a href="#immutable-constructors">Immutable Constructors</a></li>
  </ul>
</nav>
    </div>
</div>
        <div class="middlecolumn"><div class="breadcrumbs">
    <h2 class="breadcrumbs">BreadCrumbs</h2>
    <ul class="breadcrumbs">
        <li class="breadcrumbs"><a href="/" class="breadcrumbs">/Michael&#39;s Home Page</a></li>
        <li class="breadcrumbs"><a href="/principles/" class="breadcrumbs">/Principles</a></li>
    </ul>
</div>
            <article>
                <main>
                    <h1 class="title">Defensive Programming</h1>
<p>Defensive programming is a design pattern where each component in software acts very defensive in nature.
For example:</p>
<ul>
<li>Fields become private.</li>
<li>Classes are often made immutable.</li>
<li>Functions validate all of their inputs very strictly.</li>
</ul>
<p>It might also lead to adopting certain code patterns such as:</p>
<ul>
<li>The Singleton.</li>
<li>The Builder.</li>
<li>The Factory class.</li>
</ul>
<p>I would like to argue, from my experience, that:</p>
<ul>
<li>Defensive programming is more or less useful depending on the programming language.</li>
<li>Your number one defense against bad code should be TESTS!  Not defensive coding patterns.</li>
</ul>
<h1 id="immutability">Immutability</h1>
<p>An immutable class is one whose fields cannot be updated once it has been created.  They
tend to be far safer to use in code, because they basically cannot be corrupted.  Also they
are naturally thread safe, multiple threads can refer to them because none of them can
alter the object.  Programs that use immutable objects tend to have fewer bugs.</p>
<h1 id="fluent-pattern">Fluent Pattern</h1>
<p>The fluent pattern is not a defensive programming pattern, it is included here to draw its
similarities to others.  Fluent classes are written in a way that you can chain together
functions that set fields on the class.  The class is mutable.</p>
<h1 id="builder-pattern">Builder Pattern</h1>
<p>The builder pattern involves having one class that is mutable, and its purpose is to build
a different immutable class.  Usually the builder has a no-argument constructor, fluent
methods to set values, and a build method.</p>
<p>There are two ways to write a builder:</p>
<ul>
<li>The builder has duplicated fields for all or most of what the final class has.
This is less likely to produce a class that can be mutated accidentally, but it also
makes it harder to maintain because fields have been duplicated.  This method is thread safe.</li>
<li>The builder holds its own private instance of the final class, which only it can modify.
The problem with this approach is you must be careful to not permit updating that
instance once it has been built.  The builder is suddently not thread safe.</li>
</ul>
<p>In practice, builders may or may not be re-used.  The downsides of using builders are:</p>
<ul>
<li>They add more complexity to your code, and hence more opportunities for bugs to creep in,
and a tougher time for co-workers to understand it.</li>
<li>They must also be unit tested.</li>
<li>They create more objects, which can add strain to garbage collectors, and hence it
requires more memory and can slow down performance.</li>
</ul>
<h1 id="factory-pattern">Factory Pattern</h1>
<p>The factory pattern is very similar to the builder pattern, but with a few differences:</p>
<ul>
<li>Factorys tend to be re-used more than builders, and are longer lived.  Builders tend
to be ephemeral.  Consequently, factory&rsquo;s lend themselves to application bootstrapping,
while builders are more commonly used at request time.</li>
<li>Once the factory is configured, it usually does not change its values.</li>
<li>Typically the factory&rsquo;s configuration is held in static variables (in java).</li>
</ul>
<p>Factory&rsquo;s also have similar downsides as builders:</p>
<ul>
<li>Added complexity</li>
<li>More required unit testing</li>
<li>If the factory uses globals (static variables), that is more risky and unsafe.</li>
</ul>
<p>If you are considering a pattern listed above, you should weigh the pros and cons, and consider
the problem you have.</p>
<h1 id="immutable-constructors">Immutable Constructors</h1>
<p>It is worth calling out here, that classes can be immutable without being produced by
a builder or factory.  They can simply have a constructor that sets their fields, and
no other methods are able to mutate them.</p>
<p>The only downside is that some immutable objects have many fields.  Somewhere between
five and seven arguments to a method, it starts to get too confusing and difficult
to maintain.  After seven arguments, a fluent pattern, a builder, or a factory pattern
becomes easier to understand.</p>
<p>You might prefer immutability when:</p>
<ul>
<li>The object is used by many parallel processes or threads.</li>
<li>The code is getting very complicated and you want to reduce risk.</li>
<li>The lifecycle of the object is quite long, spanning many requests.</li>
</ul>
<p>You might prefer mutability when:</p>
<ul>
<li>The object lifecycle is short lived and not shared by many functions.</li>
<li>Memory and garbage collection are becoming a concern.</li>
<li>You need your code to perform faster.</li>
<li>You are willing to write more unit tests to be certain everything is safe.</li>
</ul>


                </main>
            </article><hr class="footerline">
<footer>
    <a class="footerprevious" href="/algorithms/selection/" title="Selection Sort">
        <img src="/icons/left-arrow-black.png" class="footerarrow" /><span class="footerlinktext">
            previous</span></a>
    <div class="footermiddle">
        <b>&#169; 2023 Michael Knapp</b>
    </div>
    <a class="footernext" href="/tech/bash/sudo/" title="Sudo">
        <span class="footerlinktext">next </span>
        <img src="/icons/right-arrow-black.png" class="footerarrow" /></a>
</footer>
        </div>
    </div>
</body>

</html>